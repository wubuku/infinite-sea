// <autogenerated>
//   This file was generated by dddappp code generator.
//   Any changes made to this file manually will be lost next time the file is regenerated.
// </autogenerated>

package org.dddml.suiinfinitesea.sui.contract.service;

import com.github.wubuku.sui.bean.*;
import com.github.wubuku.sui.utils.*;
import org.dddml.suiinfinitesea.domain.avatar.*;
import org.dddml.suiinfinitesea.domain.*;
import org.dddml.suiinfinitesea.sui.contract.DomainBeanUtils;
import org.dddml.suiinfinitesea.sui.contract.Avatar;

import java.util.*;
import java.math.*;
import java.util.function.*;

public class SuiAvatarStateRetriever {

    private SuiJsonRpcClient suiJsonRpcClient;

    private Function<String, AvatarState.MutableAvatarState> avatarStateFactory;

    public SuiAvatarStateRetriever(SuiJsonRpcClient suiJsonRpcClient,
                                  Function<String, AvatarState.MutableAvatarState> avatarStateFactory
    ) {
        this.suiJsonRpcClient = suiJsonRpcClient;
        this.avatarStateFactory = avatarStateFactory;
    }

    public AvatarState retrieveAvatarState(String objectId) {
        SuiMoveObjectResponse<Avatar> getObjectDataResponse = suiJsonRpcClient.getMoveObject(
                objectId, new SuiObjectDataOptions(true, true, true, true, true, true, true), Avatar.class
        );
        if (getObjectDataResponse.getData() == null) {
            return null;
        }
        Avatar avatar = getObjectDataResponse.getData().getContent().getFields();
        return toAvatarState(avatar);
    }

    private AvatarState toAvatarState(Avatar avatar) {
        AvatarState.MutableAvatarState avatarState = avatarStateFactory.apply(avatar.getId().getId());
        avatarState.setVersion(avatar.getVersion());
        avatarState.setOwner(avatar.getOwner());
        avatarState.setName(avatar.getName());
        avatarState.setImageUrl(avatar.getImageUrl());
        avatarState.setDescription(avatar.getDescription());
        avatarState.setBackgroundColor(avatar.getBackgroundColor());
        avatarState.setRace(avatar.getRace());
        avatarState.setEyes(avatar.getEyes());
        avatarState.setMouth(avatar.getMouth());
        avatarState.setHaircut(avatar.getHaircut());
        avatarState.setSkin(avatar.getSkin());
        avatarState.setOutfit(avatar.getOutfit());
        avatarState.setAccessories(avatar.getAccessories());
        avatarState.setAura(avatar.getAura());
        avatarState.setSymbols(avatar.getSymbols());
        avatarState.setEffects(avatar.getEffects());
        avatarState.setBackgrounds(avatar.getBackgrounds());
        avatarState.setDecorations(avatar.getDecorations());
        avatarState.setBadges(avatar.getBadges());
        return avatarState;
    }

    
}

